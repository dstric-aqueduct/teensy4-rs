<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A Rust board support package (BSP) for the Teensy 4. Supports the Teensy 4.0 and 4.1 boards."><meta name="keywords" content="rust, rustlang, rust-lang, teensy4_bsp"><title>teensy4_bsp - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../normalize.css"><link rel="stylesheet" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../ayu.css" disabled><link rel="stylesheet" href="../dark.css" disabled><link rel="stylesheet" href="../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../storage.js"></script><script defer src="../crates.js"></script><script defer src="../main.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../favicon.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../teensy4_bsp/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../teensy4_bsp/index.html"><div class="logo-container"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Crate teensy4_bsp</a></h2><div class="sidebar-elems"><div class="block"><ul><li class="version">Version 0.3.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul></div><section><div class="block"><ul><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li><li><a href="#types">Type Definitions</a></li></ul></div></section></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../teensy4_bsp/index.html"><img class="rust-logo" src="../rust-logo.svg" alt="logo"></a><nav class="sub"><form class="search-form"><div class="search-container"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><button type="button">?</button></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../wheel.svg"></a></div></div></form></nav></div><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">teensy4_bsp</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../src/teensy4_bsp/lib.rs.html#1-128">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A Rust board support package (BSP) for the Teensy 4. Supports the Teensy 4.0 and
4.1 boards.</p>
<p>Peripherals are re-exported from the <a href="imxrt_hal"><code>imxrt-hal</code></a>
hardware abstraction layer. See the HAL’s documentation for more information on creating
and using peripherals.</p>
<h2 id="runtime"><a href="#runtime">Runtime</a></h2>
<p>The <code>teensy4-bsp</code> use the <a href="https://crates.io/crates/cortex-m-rt"><code>cortex-m-rt</code></a> crate to provide a runtime. Enable runtime support using
the <code>&quot;rt&quot;</code> feature. To properly link your program, you <strong>must link with the <code>t4link.x</code> linker
script</strong>.</p>
<p>The <code>teensy4-bsp</code> emits a <code>cortex-m-rt</code>-compatible linker script. The layout supports the i.MX RT’s boot requirements
and advanced memory features. Specifically, the layout includes the image vector table (IVT) and boot data
that’s necessary for i.MX RT processors. Additionally, the layout specifies the FlexSPI configuration block’s (FCB)
FLASH location. Finally, the linker script places all instructions in ITCM, and all data in DTCM.</p>
<p>The <code>teensy4-bsp</code> provides its own reset hander. The custom reset handler</p>
<ul>
<li>initalizes TCM regions</li>
<li>copies instructions into ITCM</li>
<li>copies the vector table into DTCM, and sets VTOR</li>
<li>set’s the CCM’s low-power setting</li>
</ul>
<p>The reset handler then calls the <code>cortex-m-rt</code> entrypoint to finish memory initialization and invoke your program’s
<code>main()</code>.</p>
<h2 id="features"><a href="#features">Features</a></h2>
<p>The <code>teensy4-bsp</code> supports these features:</p>
<div><table><thead><tr><th>Flag</th><th>Description</th><th>Default?</th></tr></thead><tbody>
<tr><td><code>&quot;usb-logging&quot;</code></td><td>Adds support for logging over USB with the <code>log</code> crate</td><td>✓</td></tr>
<tr><td><code>&quot;rt&quot;</code></td><td>Adds runtime support using <code>cortex-m-rt</code></td><td></td></tr>
<tr><td><code>&quot;rtic&quot;</code></td><td>Adds support for using the BSP peripherals with RTIC</td><td></td></tr>
</tbody></table>
</div>
<p>Proper RTIC support requires that you disable the BSP’s default features. You may combine <code>&quot;rtic&quot;</code> with
either <code>&quot;rt&quot;</code> and <code>&quot;usb-logging&quot;</code>.</p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies.teensy4-bsp]
default-features = false
features = [&quot;rtic&quot;,  &quot;rt&quot;]
version = # ...</code></pre></div><h2 id="pins"><a href="#pins">Pins</a></h2>
<p>The BSP helps you convert all the i.MX RT processor pads into your Teensy 4’s pins.
From these pins, you may construct peripherals and perform I/O. See the [<code>pins</code>] module
for more information.</p>
<h2 id="examples"><a href="#examples">Examples</a></h2>
<p>Turn on a Teensy 4.0’s LED:</p>

<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>cortex_m::asm::wfi;
<span class="kw">use </span>teensy4_bsp <span class="kw">as </span>bsp;

<span class="kw">use </span>embedded_hal::digital::v2::OutputPin;

<span class="kw">let </span>peripherals = bsp::Peripherals::take().unwrap();
<span class="kw">let </span>pins = bsp::pins::t40::from_pads(peripherals.iomuxc);
<span class="kw">let </span><span class="kw-2">mut </span>led = bsp::configure_led(pins.p13);

<span class="kw">loop </span>{
    led.set_high().unwrap();
    wfi();
}</code></pre></div>
<p>See more examples in the project’s repository.</p>
</div></details><h2 id="reexports" class="small-section-header"><a href="#reexports">Re-exports</a></h2><div class="item-table"><div class="item-row"><div class="item-left import-item" id="reexport.pins"><code>pub use teensy4_pins as pins;</code></div></div><div class="item-row"><div class="item-left import-item" id="reexport.hal"><code>pub use imxrt_hal as hal;</code></div></div></div><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="mod" href="usb/index.html" title="teensy4_bsp::usb mod">usb</a><span class="stab portability" title="Available on crate feature `usb-logging` only"><code>usb-logging</code></span></div><div class="item-right docblock-short">Teensy 4 USB, taken from the original Teensy 4 C libraries</div></div></div><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Peripherals.html" title="teensy4_bsp::Peripherals struct">Peripherals</a></div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.interrupt.html" title="teensy4_bsp::interrupt enum">interrupt</a></div><div class="item-right docblock-short">Available interrupts for this device</div></div></div><h2 id="constants" class="small-section-header"><a href="#constants">Constants</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="constant" href="constant.EXT_SYSTICK_HZ.html" title="teensy4_bsp::EXT_SYSTICK_HZ constant">EXT_SYSTICK_HZ</a></div><div class="item-right docblock-short">SYSTICK external clock frequency.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.configure_led.html" title="teensy4_bsp::configure_led fn">configure_led</a></div><div class="item-right docblock-short">Configure the board’s LED</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.dtcm_heap_start.html" title="teensy4_bsp::dtcm_heap_start fn">dtcm_heap_start</a></div><div class="item-right docblock-short">Returns the starting location for a DTCM “heap.”</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.heap_len.html" title="teensy4_bsp::heap_len fn">heap_len</a></div><div class="item-right docblock-short">Returns the size of the heap, in bytes.</div></div><div class="item-row"><div class="item-left module-item"><a class="fn" href="fn.heap_start.html" title="teensy4_bsp::heap_start fn">heap_start</a></div><div class="item-right docblock-short">Returns a pointer to the start of the heap</div></div></div><h2 id="types" class="small-section-header"><a href="#types">Type Definitions</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="type" href="type.Led.html" title="teensy4_bsp::Led type">Led</a></div><div class="item-right docblock-short">The LED</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../" data-current-crate="teensy4_bsp" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.0-nightly (57f097ea2 2022-10-01)" ></div></body></html>